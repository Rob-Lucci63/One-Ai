<!DOCTYPE html><html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Happy Coin - نسخه سخت‌تر</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#111; color:#fff; font-family:sans-serif; overflow:hidden; }
    #player { position:absolute; width:40px; height:40px; background:#f00; border-radius:50%; top:50%; left:50%; transform:translate(-50%,-50%); }
    .coin { position:absolute; width:30px; height:30px; background:gold; border-radius:50%; cursor:pointer; transition:transform .2s; }
    .coin:active { transform:scale(0.9); }
    #info { position:fixed; top:10px; left:10px; font-size:18px; }
  </style>
</head>
<body>
  <div id="player"></div>
  <div id="info">جون: 3 | خنثی‌سازی: 0</div>  <script>
    const player = document.getElementById('player');
    const info = document.getElementById('info');
    let lives = 3;
    let kills = 0;
    let canAttack = true;
    const attackCooldown = 2000; // 2 ثانیه

    // حرکت بازیکن با موس
    document.addEventListener('mousemove', e => {
      const x = e.clientX - player.offsetWidth/2;
      const y = e.clientY - player.offsetHeight/2;
      player.style.left = x + 'px';
      player.style.top = y + 'px';
    });

    // تولید سکه (دشمن)
    function spawnCoin() {
      const coin = document.createElement('div');
      coin.classList.add('coin');
      // شروع تصادفی
      coin.style.left = Math.random() * (window.innerWidth-30) + 'px';
      coin.style.top = Math.random() * (window.innerHeight-30) + 'px';
      document.body.appendChild(coin);

      // جهت تصادفی و سرعت
      const angle = Math.random()*Math.PI*2;
      const speed = 1 + Math.random();
      const vx = Math.cos(angle)*speed;
      const vy = Math.sin(angle)*speed;

      // کلیک برای حمله
      coin.addEventListener('click', e => {
        if (!canAttack) return;
        canAttack = false;
        kills++;
        info.textContent = `جون: ${lives} | خنثی‌سازی: ${kills}`;
        coin.remove();
        setTimeout(() => canAttack = true, attackCooldown);
        e.stopPropagation();
      });

      // حرکت سکه و برخورد
      function move() {
        const rect = coin.getBoundingClientRect();
        let x = rect.left + vx;
        let y = rect.top + vy;
        // برخورد با دیواره
        if (x < 0 || x > window.innerWidth-rect.width) {
          x = Math.max(0, Math.min(x, window.innerWidth-rect.width));
        }
        if (y < 0 || y > window.innerHeight-rect.height) {
          y = Math.max(0, Math.min(y, window.innerHeight-rect.height));
        }
        coin.style.left = x + 'px';
        coin.style.top = y + 'px';
        // برخورد با بازیکن
        const p = player.getBoundingClientRect();
        const c = coin.getBoundingClientRect();
        if (p.left < c.right && p.right > c.left && p.top < c.bottom && p.bottom > c.top) {
          lives--;
          info.textContent = `جون: ${lives} | خنثی‌سازی: ${kills}`;
          coin.remove();
          if (lives <= 0) {
            alert('باختی! تعداد خنثی‌سازی‌ها: '+kills);
            location.reload();
            return;
          }
        }
        requestAnimationFrame(move);
      }
      move();
    }

    // ایجاد سکه هر 1.2 ثانیه
    setInterval(spawnCoin, 1200);

    // اندازه‌ صفحه تغییر
    window.addEventListener('resize', () => { /* اختیاری */ });

  </script></body>
</html>